<html lang="fr">
<head>
    <title>Révision de français CE1 - Grammaire !</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="styles.css"> 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script> 
</head>
<body>
    <header>
        <h1>Révision de français CE1</h1> 
        <nav>
            <ul>
                <li><a href="accueil1.html">Accueil</a></li>
                <li><a href="lexique.html">Lexique</a></li>
                <li><a href="conjugaison.html">Conjugaison</a></li>
                <li><a href="grammaire.html">Grammaire</a></li>
                <li><a href="orthographe.html">Orthographe</a></li>
                <li><a href="lecture.html">Lecture</a></li>
                <li><a href="dictée.html">Dictée</a></li>
                <li><a href="bilan.html">Bilan</a></li>
            </ul>
        </nav>
    </header>
    <div id="ref">
        <p>Choisis le bon pronom !</p> <!--consigne-->
    </div>
    <section>
        <article>
            <h2>Exercice</h2>
            <p class="phrase">
                <span class="zoneàglisser">Marie et moi</span> mangeons des galettes au sarrasin.  <!--zone où l'utilisateur dépose-->
            </p>
            <div>
                <!--réponses glissables-->
                <span class="àglisser" draggable="true" data-correct="false">Elles</span>
                <span class="àglisser" draggable="true" data-correct="false">Ils</span>
                <span class="àglisser" draggable="true" data-correct="true">Nous</span>
            </div>
            <p class="retour"></p> <!--affiche le résultat-->
        </article>
        <article>
            <p class="phrase">
                <span class="zoneàglisser">Le chat</span> a faim.
            </p>
            <div>
                <span class="àglisser" draggable="true" data-correct="false">Elle</span>
                <span class="àglisser" draggable="true" data-correct="true">Il</span>
                <span class="àglisser" draggable="true" data-correct="false">Ils</span>
            </div>
            <p class="retour"></p>
        </article>
        <article>
            <p class="phrase">
                <span class="zoneàglisser">Lola et son frère</span> vont à la piscine.
            </p>
            <div>
                <span class="àglisser" draggable="true" data-correct="false">Elle</span>
                <span class="àglisser" draggable="true" data-correct="false">Il</span>
                <span class="àglisser" draggable="true" data-correct="true">Ils</span>
            </div>
            <p class="retour"></p>
        </article>
        <article>
            <p class="phrase">
                <span class="zoneàglisser">La boutique</span> est fermée le lundi.
            </p>
            <div>
                <span class="àglisser" draggable="true" data-correct="false">Il</span>
                <span class="àglisser" draggable="true" data-correct="false">Elles</span>
                <span class="àglisser" draggable="true" data-correct="true">Elle</span>
            </div>
            <p class="retour"></p>
        </article>
        <div id="bilan1" style="text-align: center;">
            <button id="bilan">Bilan</button> <!--bouton pour afficher le score final-->
            <p id="score"></p> <!--affiche score final-->
        </div>
    </section>
<script>
    $(document).ready(function () {
        let draggedData = null; //variable pour stocker les données de l'élément glissé
        $(".àglisser").on("dragstart", function () { //début du glissement
            draggedData = { //stocke les données de l'élément glissé
                correct: $(this).data("correct"), //si la réponse est correcte
                text: $(this).text(), //récupère le texte de l'élément glissé
            };
        });
        $(".zoneàglisser").on("dragover", function (event) { //survol zone à glisser
            event.preventDefault(); //fait fonctionner le dépot
            $(this).addClass("highlight"); //surbrillance
        });
        $(".zoneàglisser").on("dragleave", function () { //sortie zone à glisser
            $(this).removeClass("highlight"); //enlève surbrillance
        });
        $(".zoneàglisser").on("drop", function () { //dépôt de l'élément dans la zone
            $(this).removeClass("highlight"); //enlève surbrillance
            if (draggedData) { //vérifie qu'un élément a été glissé
                $(this).text(draggedData.text); //texte glissé dans la zone à glisser
                const retour = $(this).closest("article").find(".retour").first(); //zone de retour
                if (draggedData.correct) { //si bonne réponse
                    retour.text("Vrai !"); //affiche "Vrai!"
                } else { //si mauvaise réponse
                    retour.text("Faux !"); //affiche "Faux!"
                }
            }
        });
        $("#bilan").on("click", function () { //clic bouton Bilan
            let totalCorrect = 0; //initialise le compteur de bonnes réponses
            $(".retour").each(function () { //parcourt tous les éléments de retour
                if ($(this).text().trim() === "Vrai !") { //si c'est vrai
                    totalCorrect++; //incrémentation du compteur
                }
            });
            $("#score").text("Tu as " + totalCorrect + " bonne(s) réponse(s) sur 4."); //affiche score final
        localStorage.setItem("grammaire_score", totalCorrect); 
    console.log("Grammaire score enregistré :", totalCorrect); //
	   });
    });
</script>
</body>
</html>